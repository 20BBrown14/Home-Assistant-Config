- id: '1668369074264'
  alias: Wax Warmer Safety
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: b1f048780390b20bdff5fec7f0a8718a
    entity_id: switch.wax_warmer
    domain: switch
    for:
      hours: 5
      minutes: 0
      seconds: 0
  condition: []
  action:
  - type: turn_off
    device_id: b1f048780390b20bdff5fec7f0a8718a
    entity_id: switch.wax_warmer
    domain: switch
  mode: single
- id: '1668370715281'
  alias: Garage Door Opening
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 0bf36539db8d07d0911c6ef021a6f0b5
    entity_id: fd29b271b27b1fe7b648db16fee5a07d
    domain: binary_sensor
  condition: []
  action:
  - service: media_player.volume_set
    data:
      volume_level: 0.75
    target:
      entity_id:
      - media_player.basement_speaker
      - media_player.kitchen_speaker
      - media_player.master_bedroom_speaker
  - service: scene.create
    data:
      snapshot_entities:
      - light.outdoor_sconce_light_1
      - light.outdoor_sconce_light_2
      - light.outdoor_sconce_light_3
      - light.outdoor_sconce_light_4
      scene_id: sconce_lights_previous
  - parallel:
    - if:
      - condition: sun
        before: sunrise
        before_offset: '1:00:00'
        after: sunset
        after_offset: '-1:00:00'
      then:
      - service: input_boolean.turn_on
        data: {}
        target:
          entity_id: input_boolean.frontyard_visibility
    - service: script.set_garage_door_status_leds
      data: {}
      enabled: true
    - type: turn_on
      device_id: 171c8f1cbdc67a075d1170858166fd45
      entity_id: switch.wall_dimmer_switch_2
      domain: switch
      enabled: true
    - if:
      - condition: or
        conditions:
        - condition: time
          before: '23:00:00'
          after: 08:00:00
          weekday:
          - mon
          - tue
          - wed
          - thu
          - fri
        - condition: time
          before: '23:30:00'
          after: 09:30:00
          weekday:
          - sun
          - sat
      - condition: state
        entity_id: input_boolean.quiet_mode
        state: 'off'
        enabled: true
      then:
      - parallel:
        - service: notify.google_assistant_sdk
          data:
            message: Garage Door Opening
          enabled: true
  - delay:
      hours: 0
      minutes: 0
      seconds: 15
      milliseconds: 0
  - parallel:
    - parallel:
      - service: media_player.volume_set
        data:
          volume_level: '{{basementSpeakerVolume}}'
        target:
          entity_id: media_player.basement_speaker
      - service: media_player.volume_set
        data:
          volume_level: '{{kitchenSpeakerVolume}}'
        target:
          entity_id: media_player.kitchen_speaker
      - service: media_player.volume_set
        data:
          volume_level: '{{masterBedroomSpeakerVolume}}'
        target:
          entity_id: media_player.master_bedroom_speaker
  variables:
    wasBasementPlaying: '{{states(''media_player.basement_speaker'') == ''playing''
      or states(''media_player.basement_speaker'') == ''buffering''}}'
    wasKitchenPlaying: '{{states(''media_player.kitchen_speaker'') == ''playing''
      or states(''media_player.kitchen_speaker'') == ''buffering''}}'
    wasMasterBedroomPlaying: '{{states(''media_player.master_bedroom_speaker'') ==
      ''playing'' or states(''media_player.master_bedroom_speaker'') == ''buffering''}}'
    basementSpeakerVolume: '{{state_attr(''media_player.basement_speaker'', ''volume_level'')
      or 0.5}}'
    kitchenSpeakerVolume: '{{state_attr(''media_player.kitchen_speaker'', ''volume_level'')
      or 0.5}}'
    masterBedroomSpeakerVolume: '{{state_attr(''media_player.master_bedroom_speaker'',
      ''volume_level'') or 0.5}}'
  mode: single
- id: '1668373428361'
  alias: Garage Door Closed
  description: ''
  trigger:
  - type: not_opened
    platform: device
    device_id: 0bf36539db8d07d0911c6ef021a6f0b5
    entity_id: fd29b271b27b1fe7b648db16fee5a07d
    domain: binary_sensor
    id: immediate
  - type: not_opened
    platform: device
    device_id: 0bf36539db8d07d0911c6ef021a6f0b5
    entity_id: fd29b271b27b1fe7b648db16fee5a07d
    domain: binary_sensor
    id: 3-mins
    for:
      hours: 0
      minutes: 3
      seconds: 0
  condition: []
  action:
  - if:
    - condition: trigger
      id: immediate
    then:
    - service: script.reset_garage_status_leds
      data: {}
  - if:
    - condition: trigger
      id: 3-mins
    then:
    - parallel:
      - type: turn_off
        device_id: 171c8f1cbdc67a075d1170858166fd45
        entity_id: switch.wall_dimmer_switch_2
        domain: switch
      - service: input_boolean.turn_off
        data: {}
        target:
          entity_id: input_boolean.frontyard_visibility
  mode: single
- id: '1668373463761'
  alias: Garage Light Turned On
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: 171c8f1cbdc67a075d1170858166fd45
    entity_id: switch.wall_dimmer_switch_2
    domain: switch
  condition: []
  action:
  - service: script.set_garage_light_status_leds
    data: {}
  mode: single
- id: '1668373534966'
  alias: Garage Light Turned Off
  description: ''
  trigger:
  - platform: device
    type: turned_off
    device_id: 171c8f1cbdc67a075d1170858166fd45
    entity_id: switch.wall_dimmer_switch_2
    domain: switch
  condition: []
  action:
  - service: script.reset_garage_light_status_leds
    data: {}
  mode: single
- id: '1668374110867'
  alias: Garage Door Opened 30 Min Warning
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 0bf36539db8d07d0911c6ef021a6f0b5
    entity_id: fd29b271b27b1fe7b648db16fee5a07d
    domain: binary_sensor
    for:
      hours: 0
      minutes: 30
      seconds: 0
  condition:
  - condition: state
    entity_id: automation.disable_garage_light_timer
    state: 'off'
  action:
  - repeat:
      until:
      - condition: device
        device_id: f0a84228db7888b84cbdda3273020bcd
        domain: cover
        entity_id: cover.garage_door
        type: is_closed
      sequence:
      - service: notify.google_assistant_sdk
        data:
          message: Garage door has been open for more than 30 minutes
      - delay:
          hours: 0
          minutes: 0
          seconds: 5
          milliseconds: 0
      - parallel:
        - service: media_player.volume_set
          data:
            volume_level: '{{basementSpeakerVolume}}'
          target:
            entity_id: media_player.basement_speaker
        - service: media_player.volume_set
          data:
            volume_level: '{{kitchenSpeakerVolume}}'
          target:
            entity_id: media_player.kitchen_speaker
        - service: media_player.volume_set
          data:
            volume_level: '{{masterBedroomSpeakerVolume}}'
          target:
            entity_id: media_player.master_bedroom_speaker
      - delay:
          hours: 0
          minutes: 30
          seconds: 0
          milliseconds: 0
      - device_id: 86b1b485f0e733b3962457c610d02eae
        domain: mobile_app
        type: notify
        message: Garage Door has been open for longer than 30 minutes
        title: Garage Door Still Open!
  variables:
    wasBasementPlaying: '{{states(''media_player.basement_speaker'') == ''playing''
      or states(''media_player.basement_speaker'') == ''buffering''}}'
    wasKitchenPlaying: '{{states(''media_player.kitchen_speaker'') == ''playing''
      or states(''media_player.kitchen_speaker'') == ''buffering''}}'
    wasMasterBedroomPlaying: '{{states(''media_player.master_bedroom_speaker'') ==
      ''playing'' or states(''media_player.master_bedroom_speaker'') == ''buffering''}}'
    basementSpeakerVolume: '{{state_attr(''media_player.basement_speaker'', ''volume_level'')
      or 0.5}}'
    kitchenSpeakerVolume: '{{state_attr(''media_player.kitchen_speaker'', ''volume_level'')
      or 0.5}}'
    masterBedroomSpeakerVolume: '{{state_attr(''media_player.master_bedroom_speaker'',
      ''volume_level'') or 0.5}}'
  mode: single
- id: '1668380333956'
  alias: Kitchen Lights Turned Off
  description: ''
  trigger:
  - platform: device
    type: turned_off
    device_id: 93ba05451716dba297c5d26e20d1e2b6
    entity_id: switch.in_wall_paddle_switch_qfsw_500s_2
    domain: switch
  condition: []
  action:
  - if:
    - condition: and
      conditions:
      - condition: state
        entity_id: input_boolean.good_night_mode
        state: 'on'
      - condition: state
        state: 'off'
        entity_id: light.basement_light
      - condition: or
        conditions:
        - condition: time
          before: 08:00:00
          after: '23:00:00'
          weekday:
          - mon
          - tue
          - wed
          - thu
        - condition: time
          before: 09:30:00
          after: '23:30:00'
          weekday:
          - sat
          - sun
    then:
    - service: script.reset_kitchen_leds
      data: {}
    else:
    - if:
      - condition: and
        conditions:
        - condition: state
          entity_id: input_boolean.good_night_mode
          state: 'on'
      then:
      - service: script.set_kitchen_leds_idle_low_brightness
        data: {}
      else:
      - service: script.set_kitchen_leds_idle
        data: {}
  mode: single
- id: '1668380371231'
  alias: Trigger Kitchen LEDs - Cooking
  description: ''
  trigger:
  - platform: device
    device_id: 93ba05451716dba297c5d26e20d1e2b6
    domain: zwave_js
    type: event.value_notification.central_scene
    property: scene
    property_key: '001'
    endpoint: 0
    command_class: 91
    subtype: Endpoint 0 Scene 001
    value: 3
  condition: []
  action:
  - service: script.set_kitchen_leds_cooking_mode
    data: {}
  - type: turn_on
    device_id: 93ba05451716dba297c5d26e20d1e2b6
    entity_id: switch.in_wall_paddle_switch_qfsw_500s_2
    domain: switch
  mode: single
- id: '1668381021752'
  alias: Trigger Kitchen LEDs - Occupied
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: 93ba05451716dba297c5d26e20d1e2b6
    entity_id: switch.in_wall_paddle_switch_qfsw_500s_2
    domain: switch
  condition: []
  action:
  - if:
    - condition: template
      value_template: '{{ (now() -  state_attr(''automation.trigger_kitchen_leds_cooking'',
        ''last_triggered'')).seconds > 10 }}'
    then:
    - service: script.set_kitchen_leds_occupied
      data: {}
  mode: single
- id: '1668382091059'
  alias: Turn off Kitchen LEDs in PM
  description: ''
  trigger:
  - platform: time
    at: '23:30:00'
  condition: []
  action:
  - repeat:
      until:
      - condition: and
        conditions:
        - condition: state
          entity_id: light.rgbw_dimmer_2
          state: 'off'
        - condition: state
          entity_id: light.rgbw_dimmer_3
          state: 'off'
        - condition: state
          entity_id: light.rgbw_dimmer_4
          state: 'off'
        - condition: state
          entity_id: light.rgbw_dimmer_5
          state: 'off'
      sequence:
      - if:
        - condition: state
          state: 'off'
          for:
            hours: 0
            minutes: 10
            seconds: 0
          entity_id: light.basement_light
        - condition: state
          entity_id: input_boolean.good_night_mode
          state: 'on'
        then:
        - service: script.reset_kitchen_leds
          data: {}
        else:
        - delay:
            hours: 0
            minutes: 10
            seconds: 0
            milliseconds: 0
  mode: single
- id: '1668382172666'
  alias: Turn on Kitchen LEDs in AM
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.good_night_mode
    to: 'off'
  condition: []
  action:
  - if:
    - condition: device
      type: is_off
      device_id: 93ba05451716dba297c5d26e20d1e2b6
      entity_id: switch.in_wall_paddle_switch_qfsw_500s_2
      domain: switch
    then:
    - service: script.set_kitchen_leds_idle
      data: {}
    else:
    - service: script.set_kitchen_leds_occupied
      data: {}
  mode: single
- id: '1668382431877'
  alias: Turn on Deck Lights at Sunset
  description: ''
  trigger:
  - platform: sun
    event: sunset
    offset: '-1:00:00'
  condition:
  - condition: time
    before: 00:00:00
    weekday:
    - fri
    - sat
    - wed
    - mon
  action:
  - service: switch.turn_on
    data: {}
    target:
      entity_id: switch.backyard_lights
  mode: single
- id: '1668382517143'
  alias: Turn off Deck Lights in PM
  description: ''
  trigger:
  - platform: time
    at: '23:30:00'
  condition: []
  action:
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.backyard_lights
  mode: single
- id: '1668384372156'
  alias: Trigger Get Ready for Bed
  description: ''
  trigger:
  - platform: device
    device_id: fc14d585e20bc18f0fae2b868f5849f3
    domain: zwave_js
    type: event.value_notification.central_scene
    property: scene
    property_key: '001'
    endpoint: 0
    command_class: 91
    subtype: Endpoint 0 Scene 001
    value: 3
  condition: []
  action:
  - service: script.get_ready_for_bed
    data: {}
  mode: single
- id: '1668384398280'
  alias: Trigger Empty Master Bedroom
  description: ''
  trigger:
  - platform: device
    device_id: fc14d585e20bc18f0fae2b868f5849f3
    domain: zwave_js
    type: event.value_notification.central_scene
    property: scene
    property_key: '002'
    endpoint: 0
    command_class: 91
    subtype: Endpoint 0 Scene 002
    value: 3
  condition: []
  action:
  - service: script.empty_master_bedroom
    data: {}
  mode: single
- id: '1668384540643'
  alias: Turn on Frontyard Lights
  description: ''
  trigger:
  - platform: device
    device_id: 7667289dac32e9792162b70cc2af7484
    domain: zwave_js
    type: event.value_notification.central_scene
    property: scene
    property_key: '001'
    endpoint: 0
    command_class: 91
    subtype: Endpoint 0 Scene 001
    value: 3
  - platform: sun
    event: sunset
    offset: '-1:00:00'
  condition: []
  action:
  - if:
    - condition: state
      entity_id: input_boolean.holiday_light_season
      state: 'on'
    then:
    - service: script.turn_on_holiday_lights
      data: {}
    - service: input_boolean.turn_on
      data: {}
      target:
        entity_id: input_boolean.holiday_light_mode
    else:
    - service: script.turn_on_frontyard_lights_idle
      data: {}
  mode: restart
- id: '1668384757377'
  alias: Turn off Frontyard Lights
  description: ''
  trigger:
  - platform: time
    at: 01:00:00
  - platform: device
    device_id: 7667289dac32e9792162b70cc2af7484
    domain: zwave_js
    type: event.value_notification.central_scene
    property: scene
    property_key: '002'
    endpoint: 0
    command_class: 91
    subtype: Endpoint 0 Scene 002
    value: 3
  condition: []
  action:
  - if:
    - condition: state
      entity_id: input_boolean.holiday_light_mode
      state: 'on'
    then:
    - service: script.turn_off_holiday_lights
      data: {}
    - service: input_boolean.turn_off
      data: {}
      target:
        entity_id: input_boolean.holiday_light_mode
    else:
    - service: light.turn_off
      data: {}
      target:
        entity_id: light.frontyard_lights
    - type: turn_off
      device_id: 7667289dac32e9792162b70cc2af7484
      entity_id: c0bd051cafd9549eceb53d7e10e2e979
      domain: switch
  mode: single
- id: '1668385139698'
  alias: Motion in Garage
  description: ''
  trigger:
  - type: motion
    platform: device
    device_id: 64f87538bc7680d16b9d62de3e259936
    entity_id: binary_sensor.z_wave_motion_sensor_motion_detection
    domain: binary_sensor
  condition: []
  action:
  - type: turn_on
    device_id: 171c8f1cbdc67a075d1170858166fd45
    entity_id: switch.wall_dimmer_switch_2
    domain: switch
  mode: single
- id: '1668385202787'
  alias: Motion Stopped in Garage
  description: ''
  trigger:
  - type: no_motion
    platform: device
    device_id: 64f87538bc7680d16b9d62de3e259936
    entity_id: binary_sensor.z_wave_motion_sensor_motion_detection
    domain: binary_sensor
    for:
      hours: 0
      minutes: 10
      seconds: 0
  condition:
  - condition: state
    entity_id: input_boolean.garage_light_timers_disabled
    state: 'off'
  action:
  - type: turn_off
    device_id: 171c8f1cbdc67a075d1170858166fd45
    entity_id: switch.wall_dimmer_switch_2
    domain: switch
  - type: turn_off
    device_id: 3a7eaf9ea0e6d8a7074a460e70917e59
    entity_id: switch.garage_led_bar
    domain: switch
  mode: single
- id: '1668385958360'
  alias: Toggle Bedside Lamp
  description: ''
  trigger:
  - platform: device
    domain: mqtt
    device_id: 4123d53d80bf262f32a413067ab8812b
    type: action
    subtype: single
    discovery_id: 0x00158d0008393dbe action_single
  condition: []
  action:
  - type: toggle
    device_id: baf57ba037f975caf4dced6631ef5ce8
    entity_id: b7d915334e8a7fb6547fe9806c33eb9e
    domain: switch
  mode: single
- id: '1668465157914'
  alias: Trash Reminder
  description: ''
  trigger:
  - platform: time
    at: '19:00:00'
  - platform: time
    at: 06:30:00
  condition:
  - condition: or
    conditions:
    - condition: time
      before: '23:00:00'
      after: '18:59:00'
      weekday:
      - wed
    - condition: time
      before: '14:00:00'
      after: 06:29:00
      weekday:
      - thu
  action:
  - parallel:
    - if:
      - condition: not
        conditions:
        - condition: or
          conditions:
          - condition: state
            entity_id: input_boolean.trash_has_been_taken_out
            state: 'on'
          - condition: or
            conditions:
            - condition: time
              before: 00:00:00
              after: '23:01:00'
              weekday:
              - wed
            - condition: time
              before: 00:00:00
              after: '14:01:00'
              weekday:
              - thu
      then:
      - device_id: fc14d585e20bc18f0fae2b868f5849f3
        domain: zwave_js
        type: set_config_parameter
        endpoint: 0
        parameter: 24
        bitmask:
        subtype: 24 (Status LED 4 Color) on endpoint 0
        value: 5
      - device_id: fc14d585e20bc18f0fae2b868f5849f3
        domain: zwave_js
        type: set_config_parameter
        endpoint: 0
        parameter: 31
        bitmask: 8
        subtype: 31[0x8] on endpoint 0 (LED 4 Blink Status) on endpoint 0
        value: 1
      - device_id: 171c8f1cbdc67a075d1170858166fd45
        domain: zwave_js
        type: set_config_parameter
        endpoint: 0
        parameter: 24
        bitmask:
        subtype: 24 (Status LED 4 Color) on endpoint 0
        value: 5
      - device_id: 171c8f1cbdc67a075d1170858166fd45
        domain: zwave_js
        type: set_config_parameter
        endpoint: 0
        parameter: 31
        bitmask: 8
        subtype: 31[0x8] on endpoint 0 (LED 4 Blink Status) on endpoint 0
        value: 1
      - repeat:
          until:
          - condition: or
            conditions:
            - condition: state
              entity_id: input_boolean.trash_has_been_taken_out
              state: 'on'
            - condition: or
              conditions:
              - condition: time
                before: 00:00:00
                after: '23:01:00'
                weekday:
                - wed
              - condition: time
                before: 00:00:00
                after: '14:01:00'
                weekday:
                - thu
          sequence:
          - device_id: 86b1b485f0e733b3962457c610d02eae
            domain: mobile_app
            type: notify
            message: Don't forget to take the trash out!
            title: Trash Day Reminder
            data:
              tag: trash_reminder
              color: green
              actions:
              - action: TRASH_TAKEN_OUT
                title: Confirm trash has been taken out
          - device_id: 6636b1f64974c361328efbc239dceb84
            domain: mobile_app
            type: notify
            message: Don't forget to take the trash out!
            title: Trash Day Reminder
            data:
              tag: trash_reminder
              color: purple
              actions:
              - action: TRASH_TAKEN_OUT
                title: Confirm trash has been taken out
            enabled: true
          - delay:
              hours: 1
              minutes: 0
              seconds: 0
              milliseconds: 0
    - if:
      - condition: not
        conditions:
        - condition: or
          conditions:
          - condition: state
            entity_id: input_boolean.trash_has_been_taken_out
            state: 'on'
          - condition: or
            conditions:
            - condition: time
              before: 00:00:00
              after: '23:01:00'
              weekday:
              - wed
            - condition: time
              before: 00:00:00
              after: '14:01:00'
              weekday:
              - thu
          - condition: template
            value_template: '{{ now().isocalendar().week % 2 == 0}}'
      then:
      - repeat:
          until:
          - condition: or
            conditions:
            - condition: state
              entity_id: input_boolean.trash_has_been_taken_out
              state: 'on'
            - condition: or
              conditions:
              - condition: time
                before: 00:00:00
                after: '23:01:00'
                weekday:
                - wed
              - condition: time
                before: 00:00:00
                after: '14:01:00'
                weekday:
                - thu
            - condition: template
              value_template: '{{ now().isocalendar().week % 2 == 0}}'
          sequence:
          - device_id: 86b1b485f0e733b3962457c610d02eae
            domain: mobile_app
            type: notify
            message: Don't forget to take the recycling out!
            title: Recycling Day Reminder
            data:
              tag: recycling_reminder
              actions:
              - action: RECYCLING_TAKEN_OUT
                title: Confirm recycling has been taken out
          - device_id: 6636b1f64974c361328efbc239dceb84
            domain: mobile_app
            type: notify
            message: Don't forget to take the recycling out!
            title: Recycling Day Reminder
            data:
              tag: recycling_reminder
              actions:
              - action: RECYCLING_TAKEN_OUT
                title: Confirm recycling has been taken out
          - delay:
              hours: 1
              minutes: 0
              seconds: 0
              milliseconds: 0
  mode: single
- id: '1668465206707'
  alias: Confirm Trash Taken Out
  description: ''
  trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: TRASH_TAKEN_OUT
  condition: []
  action:
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.trash_has_been_taken_out
  - device_id: fc14d585e20bc18f0fae2b868f5849f3
    domain: zwave_js
    type: set_config_parameter
    parameter: 24
    bitmask:
    subtype: 24 (Status LED 4 Color)
    value: 0
  - device_id: 171c8f1cbdc67a075d1170858166fd45
    domain: zwave_js
    type: set_config_parameter
    parameter: 24
    bitmask:
    subtype: 24 (Status LED 4 Color)
    value: 0
  - service: notify.all_mobile_phones
    data:
      message: clear_notification
      data:
        tag: trash_reminder
  mode: single
- id: '1668465562267'
  alias: Confirm Recycling Taken Out
  description: ''
  trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: RECYCLING_TAKEN_OUT
  condition: []
  action:
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.recycling_has_been_taken_out
  - service: notify.all_mobile_phones
    data:
      message: clear_notification
      data:
        tag: trash_reminder
  mode: single
- id: '1668467112500'
  alias: Weather Radio
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.nws_alert_count
  condition:
  - condition: template
    value_template: '{{ states.sensor.nws_alert_count.state | int > 0 }}'
  action:
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.weather_radio_silenced
  - parallel:
    - service: notify.mobile_app_branden_s_phone
      data:
        message: '{{state_attr(''sensor.nws_alert_event'', ''features'')|map(attribute="properties")|map(attribute="event")|join(''
          | '')}}'
        title: Weather Alert
        data:
          ttl: 0
          priority: high
          sticky: true
          color: '{{''#FF0000'' if (''warning'' in states.sensor.nws_alert_event.state|lower)
            else ''#FF9300''}}'
          actions:
          - action: SILENCE_WEATHER_NOTIFICATION
            title: Silence Weather Notification
          - action: URI
            title: View in Browser
            uri: https://alerts.weather.gov/cap/wwaatmget.php?x=KSZ105
      enabled: true
    - service: notify.mobile_app_samantha_s_phone
      data:
        message: '{{state_attr(''sensor.nws_alert_event'', ''features'')|map(attribute="properties")|map(attribute="event")|join(''
          | '')}}'
        title: Weather Alert
        data:
          sticky: true
          color: '{{''#FF0000'' if (''warning'' in states.sensor.nws_alert_event.state|lower)
            else ''#FF9300''}}'
          actions:
          - action: SILENCE_WEATHER_NOTIFICATION
            title: Silence Weather Notification
          - action: URI
            title: View in Browser
            uri: https://alerts.weather.gov/cap/wwaatmget.php?x=KSZ105
      enabled: true
    - repeat:
        count: 2
        sequence:
        - if:
          - condition: or
            conditions:
            - condition: and
              conditions:
              - condition: state
                entity_id: input_boolean.weather_radio_silenced
                state: 'off'
              - condition: time
                before: '23:00:00'
                after: 07:00:00
                weekday:
                - sun
                - mon
                - tue
                - wed
                - thu
                - fri
                - sat
              enabled: true
            - condition: template
              value_template: '{{ ''warning'' in states.sensor.nws_alert_event.state|lower}}'
            enabled: false
          - condition: and
            conditions:
            - condition: template
              value_template: '{{ ''warning'' in states.sensor.nws_alert_event.state|lower}}'
            - condition: template
              value_template: '{{ ''tornado'' in states.sensor.nws_alert_event.state|lower}}'
          then:
          - service: media_player.volume_set
            data:
              volume_level: 0.8
            target:
              entity_id:
              - media_player.basement_speaker
              - media_player.kitchen_speaker
              - media_player.master_bedroom_speaker
          - service: media_player.play_media
            data:
              media_content_id: media-source://tts/google_translate?message={{'ATTENTION...
                ATTENTION... The national weather service has issued the following
                statements... ' + state_attr('sensor.nws_alert_event', 'features')|map(attribute="properties")|map(attribute="headline")|join('...
                NEXT ALERT... ')}}
              media_content_type: provider
            target:
              entity_id:
              - media_player.kitchen_speaker
              - media_player.basement_speaker
              - media_player.master_bedroom_speaker
            enabled: true
          - service: media_player.play_media
            data:
              media_content_id: media-source://tts/google_translate?message={{'ATTENTION...
                ATTENTION... The national weather service has issued important weather
                statements.'}}
              media_content_type: provider
            target:
              entity_id:
              - media_player.kitchen_speaker
              - media_player.basement_speaker
              - media_player.master_bedroom_speaker
            enabled: false
          - delay:
              hours: 0
              minutes: 1
              seconds: 0
              milliseconds: 0
          - service: media_player.volume_set
            data:
              volume_level: 0.5
            target:
              entity_id: media_player.all_speakers
      enabled: true
  - parallel:
    - if:
      - condition: template
        value_template: '{{wasBasementPlaying == true}}'
      then:
      - service: media_player.volume_set
        data:
          volume_level: '{{basementSpeakerVolume}}'
        target:
          entity_id: media_player.basement_speaker
      - service: spotcast.start
        data:
          force_playback: true
          entity_id: media_player.basement_speaker
          limit: 20
          random_song: false
          repeat: 'off'
          shuffle: false
          offset: 0
          ignore_fully_played: false
    - if:
      - condition: template
        value_template: '{{wasKitchenPlaying == true}}'
      then:
      - service: media_player.volume_set
        data:
          volume_level: '{{kitchenSpeakerVolume}}'
        target:
          entity_id: media_player.kitchen_speaker
      - service: spotcast.start
        data:
          force_playback: true
          entity_id: media_player.kitchen_speaker
          limit: 20
          random_song: false
          repeat: 'off'
          shuffle: false
          offset: 0
          ignore_fully_played: false
    - if:
      - condition: template
        value_template: '{{wasMasterBedroomPlaying == true}}'
      then:
      - service: media_player.volume_set
        data:
          volume_level: '{{masterBedroomSpeakerVolume}}'
        target:
          entity_id: media_player.master_bedroom_speaker
      - service: spotcast.start
        data:
          force_playback: true
          entity_id: media_player.master_bedroom_speaker
          limit: 20
          random_song: false
          repeat: 'off'
          shuffle: false
          offset: 0
          ignore_fully_played: false
    enabled: false
  variables:
    wasBasementPlaying: '{{states(''media_player.basement_speaker'') == ''playing''
      or states(''media_player.basement_speaker'') == ''buffering''}}'
    wasKitchenPlaying: '{{states(''media_player.kitchen_speaker'') == ''playing''
      or states(''media_player.kitchen_speaker'') == ''buffering''}}'
    wasMasterBedroomPlaying: '{{states(''media_player.master_bedroom_speaker'') ==
      ''playing'' or states(''media_player.master_bedroom_speaker'') == ''buffering''}}'
    basementSpeakerVolume: '{{state_attr(''media_player.basement_speaker'', ''volume_level'')
      or 0.5}}'
    kitchenSpeakerVolume: '{{state_attr(''media_player.kitchen_speaker'', ''volume_level'')
      or 0.5}}'
    masterBedroomSpeakerVolume: '{{state_attr(''media_player.master_bedroom_speaker'',
      ''volume_level'') or 0.5}}'
  mode: single
- id: '1668467973795'
  alias: Silence Weather Radio
  description: ''
  trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: SILENCE_WEATHER_NOTIFICATION
  condition: []
  action:
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.weather_radio_silenced
  mode: single
- id: '1668616382871'
  alias: Turn on bedside fan
  description: ''
  trigger:
  - platform: device
    device_id: e50cb3846e82014dde1e95832d9d4e9c
    domain: zwave_js
    type: event.value_notification.central_scene
    property: scene
    property_key: '001'
    endpoint: 0
    command_class: 91
    subtype: Endpoint 0 Scene 001
    value: 3
  condition: []
  action:
  - type: toggle
    device_id: 10186c425eb8729e24fde4e484d6a531
    entity_id: switch.smart_plug_1_channel
    domain: switch
  mode: single
- id: '1668826022378'
  alias: Reset Trash Reminders
  description: ''
  trigger:
  - platform: time
    at: 08:00:00
  condition:
  - condition: time
    before: 00:00:00
    weekday:
    - wed
    after: 00:00:00
  action:
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id:
      - input_boolean.recycling_has_been_taken_out
      - input_boolean.trash_has_been_taken_out
  mode: single
- id: '1669152857813'
  alias: Toggle Garage Lights
  description: ''
  trigger:
  - platform: device
    domain: mqtt
    device_id: 3f5c22d3f62c1224844e69a476dd9aa3
    type: action
    subtype: single
    discovery_id: 0x00158d0008394a31 action_single
    id: single_click
  - platform: device
    domain: mqtt
    device_id: 3f5c22d3f62c1224844e69a476dd9aa3
    type: action
    subtype: hold
    discovery_id: 0x00158d0008394a31 action_hold
    id: hold_click
  condition: []
  action:
  - if:
    - condition: trigger
      id: single_click
    then:
    - type: toggle
      device_id: 171c8f1cbdc67a075d1170858166fd45
      entity_id: switch.wall_dimmer_switch_2
      domain: switch
  - if:
    - condition: trigger
      id: hold_click
    then:
    - type: toggle
      device_id: 3a7eaf9ea0e6d8a7074a460e70917e59
      entity_id: switch.garage_led_bar
      domain: switch
  mode: single
- id: '1669225163811'
  alias: Low Battery Notification
  description: ''
  use_blueprint:
    path: sbyx/low-battery-level-detection-notification-for-all-battery-sensors.yaml
    input:
      exclude:
        entity_id:
        - sensor.branden_s_phone_battery_level
        - sensor.samantha_s_phone_battery_level
      actions:
      - device_id: 86b1b485f0e733b3962457c610d02eae
        domain: mobile_app
        type: notify
        message: '{{sensors}}'
        title: Low Battery Notification
      threshold: 20
      time: '10:00:00'
- id: '1673115807419'
  alias: Garage Entry Opened
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 933741cce5d5e2275a126b49415cad02
    entity_id: binary_sensor.garage_door_window_door_is_open
    domain: binary_sensor
  condition: []
  action:
  - type: turn_on
    device_id: 171c8f1cbdc67a075d1170858166fd45
    entity_id: switch.wall_dimmer_switch_2
    domain: switch
    enabled: true
  - if:
    - condition: sun
      before: sunrise
      before_offset: '1:00:00'
      after: sunset
      after_offset: '-1:00:00'
    then:
    - type: turn_on
      device_id: 1f38410000bfa7512b5e118322a6f696
      entity_id: switch.entry_light
      domain: switch
  - delay:
      hours: 0
      minutes: 10
      seconds: 0
      milliseconds: 0
  - if:
    - condition: state
      entity_id: input_boolean.garage_light_timers_disabled
      state: 'off'
    then:
    - type: turn_off
      device_id: 171c8f1cbdc67a075d1170858166fd45
      entity_id: switch.wall_dimmer_switch_2
      domain: switch
  - if:
    - type: is_not_occupied
      condition: device
      device_id: cec1c9acc6998365c5762cb515ed6469
      entity_id: binary_sensor.living_room_occupancy
      domain: binary_sensor
    then:
    - type: turn_off
      device_id: 1f38410000bfa7512b5e118322a6f696
      entity_id: switch.entry_light
      domain: switch
    else:
    - wait_for_trigger:
      - type: not_occupied
        platform: device
        device_id: cec1c9acc6998365c5762cb515ed6469
        entity_id: binary_sensor.living_room_occupancy
        domain: binary_sensor
      enabled: false
    - type: turn_off
      device_id: 1f38410000bfa7512b5e118322a6f696
      entity_id: switch.entry_light
      domain: switch
      enabled: false
  mode: restart
- id: '1674073338532'
  alias: Leak detection & notification
  description: ''
  use_blueprint:
    path: TurtleFX/leak-detector-notifier.yaml
    input:
      actions:
      - device_id: 86b1b485f0e733b3962457c610d02eae
        domain: mobile_app
        type: notify
        message: "⚠️\U0001F4A6 {{ trigger.event.data.new_state.attributes.friendly_name
          }} has detected a leak! \U0001F4A6⚠️"
        title: Water leak!
      - device_id: 6636b1f64974c361328efbc239dceb84
        domain: mobile_app
        type: notify
        message: "⚠️\U0001F4A6 {{ trigger.event.data.new_state.attributes.friendly_name
          }} has detected a leak! \U0001F4A6⚠️"
        title: Water leak!
- id: '1674073683498'
  alias: Frontyard light Visibility
  description: ''
  trigger:
  - platform: device
    device_id: 1f38410000bfa7512b5e118322a6f696
    domain: zwave_js
    type: event.value_notification.central_scene
    property: scene
    property_key: '001'
    endpoint: 0
    command_class: 91
    subtype: Endpoint 0 Scene 001
    value: 4
    id: entry_light_trigger_on
  - platform: device
    device_id: 1f38410000bfa7512b5e118322a6f696
    domain: zwave_js
    type: event.value_notification.central_scene
    property: scene
    property_key: '002'
    endpoint: 0
    command_class: 91
    subtype: Endpoint 0 Scene 002
    value: 4
    id: entry_light_trigger_off
  condition: []
  action:
  - if:
    - condition: trigger
      id:
      - entry_light_trigger_on
    - condition: sun
      before: sunrise
      before_offset: '1:00:00'
      after: sunset
      after_offset: '-1:00:00'
    then:
    - service: input_boolean.turn_on
      data: {}
      target:
        entity_id: input_boolean.frontyard_visibility
  - if:
    - condition: trigger
      id:
      - entry_light_trigger_off
    then:
    - service: input_boolean.turn_off
      data: {}
      target:
        entity_id: input_boolean.frontyard_visibility
  mode: restart
- id: '1674349011766'
  alias: Turn of Master Bedroom light, delayed
  description: ''
  trigger:
  - platform: device
    device_id: fc14d585e20bc18f0fae2b868f5849f3
    domain: zwave_js
    type: event.value_notification.central_scene
    property: scene
    property_key: '002'
    endpoint: 0
    command_class: 91
    subtype: Endpoint 0 Scene 002
    value: 2
  condition: []
  action:
  - repeat:
      count: '2'
      sequence:
      - type: toggle
        device_id: fc14d585e20bc18f0fae2b868f5849f3
        entity_id: light.master_bedroom_light
        domain: light
      - delay:
          hours: 0
          minutes: 0
          seconds: 0
          milliseconds: 250
  - delay:
      hours: 0
      minutes: 6
      seconds: 0
      milliseconds: 0
  - type: turn_off
    device_id: fc14d585e20bc18f0fae2b868f5849f3
    entity_id: light.master_bedroom_light
    domain: light
  mode: restart
- id: '1674500755303'
  alias: Turn on Kitchen Light
  description: ''
  trigger:
  - platform: device
    device_id: 896c999f58ebc3aab7ebfd0e161a2ef3
    domain: zwave_js
    type: event.value_notification.central_scene
    property: scene
    property_key: '001'
    endpoint: 0
    command_class: 91
    subtype: Endpoint 0 Scene 001
    value: 3
    id: Flood-light-trigger
  condition: []
  action:
  - type: turn_on
    device_id: 93ba05451716dba297c5d26e20d1e2b6
    entity_id: switch.in_wall_paddle_switch_qfsw_500s_2
    domain: switch
  - if:
    - condition: trigger
      id: Flood-light-trigger
    then:
    - type: turn_off
      device_id: 896c999f58ebc3aab7ebfd0e161a2ef3
      entity_id: switch.flood_light
      domain: switch
  mode: single
- id: '1676406975991'
  alias: Subbasement Air Filter
  description: ''
  trigger:
  - platform: time
    at: 00:00:00
    id: 'On'
  - platform: time
    at: 07:00:00
    id: 'Off'
  condition: []
  action:
  - if:
    - condition: trigger
      id: 'On'
    then:
    - type: turn_on
      device_id: 6d227761a2477b601fc1d49c41d13a48
      entity_id: switch.subbasement_filter
      domain: switch
  - if:
    - condition: trigger
      id: 'Off'
    then:
    - type: turn_off
      device_id: 6d227761a2477b601fc1d49c41d13a48
      entity_id: switch.subbasement_filter
      domain: switch
  mode: single
- id: '1676739355156'
  alias: Disable Garage Light Timer
  description: ''
  trigger:
  - platform: device
    domain: mqtt
    device_id: 3f5c22d3f62c1224844e69a476dd9aa3
    type: action
    subtype: double
    discovery_id: 0x00158d0008394a31 action_double
    id: turn_on_1
  - platform: device
    device_id: 171c8f1cbdc67a075d1170858166fd45
    domain: zwave_js
    type: event.value_notification.central_scene
    property: scene
    property_key: '001'
    endpoint: 0
    command_class: 91
    subtype: Endpoint 0 Scene 001
    value: 2
    id: turn_on_2
  - platform: state
    entity_id:
    - input_boolean.garage_light_timers_disabled
    to: 'on'
    for:
      hours: 4
      minutes: 0
      seconds: 0
    id: turn_off_1
  - platform: device
    device_id: 171c8f1cbdc67a075d1170858166fd45
    domain: zwave_js
    type: event.value_notification.central_scene
    property: scene
    property_key: '002'
    endpoint: 0
    command_class: 91
    subtype: Endpoint 0 Scene 002
    value: 2
    id: turn_off_2
  condition: []
  action:
  - if:
    - condition: or
      conditions:
      - condition: trigger
        id: turn_on_1
      - condition: trigger
        id: turn_on_2
    then:
    - service: input_boolean.turn_on
      data: {}
      target:
        entity_id: input_boolean.garage_light_timers_disabled
    - type: turn_on
      device_id: 171c8f1cbdc67a075d1170858166fd45
      entity_id: switch.wall_dimmer_switch_2
      domain: switch
    - device_id: 171c8f1cbdc67a075d1170858166fd45
      domain: zwave_js
      type: set_config_parameter
      parameter: 31
      bitmask: 16
      subtype: 31[0x10] (LED 5 Blink Status)
      value: 0
    - device_id: 171c8f1cbdc67a075d1170858166fd45
      domain: zwave_js
      type: set_config_parameter
      parameter: 25
      bitmask:
      subtype: 25 (Status LED 5 Color)
      value: 3
  - if:
    - condition: or
      conditions:
      - condition: trigger
        id: turn_off_1
      - condition: trigger
        id: turn_off_2
    then:
    - type: turn_off
      device_id: 171c8f1cbdc67a075d1170858166fd45
      entity_id: switch.wall_dimmer_switch_2
      domain: switch
    - service: input_boolean.turn_off
      data: {}
      target:
        entity_id: input_boolean.garage_light_timers_disabled
    - device_id: 171c8f1cbdc67a075d1170858166fd45
      domain: zwave_js
      type: set_config_parameter
      parameter: 25
      bitmask:
      subtype: 25 (Status LED 5 Color)
      value: 0
  mode: restart
- id: '1677391431999'
  alias: Front Door Opened
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: ca0457c4a2a23167836611ffe6200a52
    entity_id: binary_sensor.front_door_window_door_is_open
    domain: binary_sensor
  condition: []
  action:
  - if:
    - condition: sun
      before: sunrise
      before_offset: '1:00:00'
      after: sunset
      after_offset: '-1:00:00'
    then:
    - service: input_boolean.turn_on
      data: {}
      target:
        entity_id: input_boolean.frontyard_visibility
  mode: restart
- id: '1677391512771'
  alias: Front Door Closed
  description: ''
  trigger:
  - type: not_opened
    platform: device
    device_id: ca0457c4a2a23167836611ffe6200a52
    entity_id: binary_sensor.front_door_window_door_is_open
    domain: binary_sensor
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 2
      seconds: 0
      milliseconds: 0
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.frontyard_visibility
  mode: restart
- id: '1681152888179'
  alias: Doors and Window - Climate
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.all_windows
    from: 'off'
    to: 'on'
    id: Window(s)_Opened
    for:
      hours: 0
      minutes: 10
      seconds: 0
    alias: Windows Open for 10 minutes
  - platform: state
    entity_id:
    - binary_sensor.all_doors
    from: 'off'
    to: 'on'
    id: Door(s)_Opened
    for:
      hours: 0
      minutes: 15
      seconds: 0
    alias: Doors Open for 15 minutes
  - platform: state
    entity_id:
    - binary_sensor.all_doors
    from: 'on'
    to: 'off'
    id: Door(s)_Closed
    for:
      hours: 0
      minutes: 5
      seconds: 0
    alias: Doors closed for 5 minutes
  - platform: state
    entity_id:
    - binary_sensor.all_windows
    from: 'on'
    to: 'off'
    id: Window(s)_Closed
    for:
      hours: 0
      minutes: 5
      seconds: 0
    alias: Windows closed for 5 minutes
  - type: opened
    platform: device
    device_id: a7b07bea42b31891f7476f3d3c86d4b8
    entity_id: binary_sensor.master_bedroom_window_1_contact
    domain: binary_sensor
    for:
      hours: 0
      minutes: 10
      seconds: 0
    id: master_bedroom_windows_1
  - type: opened
    platform: device
    device_id: d61ec84b8f27358063c640c92918a30c
    entity_id: binary_sensor.master_bedroom_window_2_contact
    domain: binary_sensor
    for:
      hours: 0
      minutes: 10
      seconds: 0
    id: master_bedroom_windows_2
  - type: opened
    platform: device
    device_id: e745d1a473239dbd4e97e4543ae1ddb8
    entity_id: binary_sensor.living_room_window_1_contact
    domain: binary_sensor
    for:
      hours: 0
      minutes: 10
      seconds: 0
    id: living_room_window_1_opened
  - type: opened
    platform: device
    device_id: 89a16d3809eba6acb1fccc31484038aa
    entity_id: binary_sensor.living_room_window_2_contact
    domain: binary_sensor
    for:
      hours: 0
      minutes: 10
      seconds: 0
    id: living_room_window_2_opened
  - type: opened
    platform: device
    device_id: dbc279518161d86c319c53a54a12b234
    entity_id: binary_sensor.living_room_window_3_contact
    domain: binary_sensor
    for:
      hours: 0
      minutes: 10
      seconds: 0
    id: living_room_window_3_opened
  - type: opened
    platform: device
    device_id: ca0457c4a2a23167836611ffe6200a52
    entity_id: binary_sensor.front_door_window_door_is_open
    domain: binary_sensor
    for:
      hours: 0
      minutes: 15
      seconds: 0
    id: front_door_open
  - type: opened
    platform: device
    device_id: 605f72a4446c466652d58d50cd8ea648
    entity_id: binary_sensor.kitchen_door_window_door_is_open
    domain: binary_sensor
    for:
      hours: 0
      minutes: 15
      seconds: 0
    id: kitchen_door_open
  condition: []
  action:
  - if:
    - condition: or
      conditions:
      - condition: trigger
        id: Window(s)_Opened
      - condition: trigger
        id: Door(s)_Opened
    then:
    - device_id: 0bcb5d2a9faa56f77c07a7c9da51e63d
      domain: climate
      entity_id: climate.thermostat
      type: set_hvac_mode
      hvac_mode: 'off'
    alias: Turn off thermostat if doors/windows open
  - alias: Turn on thermostat if doors/windows closed
    if:
    - condition: or
      conditions:
      - condition: trigger
        id: Door(s)_Closed
      - condition: trigger
        id: Window(s)_Closed
    - condition: state
      entity_id: binary_sensor.doors_and_windows
      state: 'off'
    - condition: device
      device_id: 0bcb5d2a9faa56f77c07a7c9da51e63d
      domain: climate
      entity_id: e0c3a51074d59749cf3e01e13c276b65
      type: is_hvac_mode
      hvac_mode: 'off'
    then:
    - device_id: 0bcb5d2a9faa56f77c07a7c9da51e63d
      domain: climate
      entity_id: climate.thermostat
      type: set_hvac_mode
      hvac_mode: heat_cool
  - if:
    - condition: or
      conditions:
      - condition: trigger
        id: master_bedroom_windows_1
      - condition: trigger
        id: master_bedroom_windows_2
    then:
    - type: turn_on
      device_id: e50cb3846e82014dde1e95832d9d4e9c
      entity_id: fan.in_wall_fan_speed_control_500s
      domain: fan
    alias: Master Bedroom
  - if:
    - condition: or
      conditions:
      - condition: trigger
        id: living_room_window_1_opened
      - condition: trigger
        id: living_room_window_2_opened
      - condition: trigger
        id: living_room_window_3_opened
      - condition: trigger
        id: front_door_open
      - condition: trigger
        id: kitchen_door_open
    then:
    - type: turn_on
      device_id: 1b34603e48a969148fd92a4667db70e9
      entity_id: switch.living_room_light
      domain: switch
    - delay:
        hours: 0
        minutes: 0
        seconds: 20
        milliseconds: 0
    - service: remote.send_command
      data:
        device: Living Room Ceiling Fan
        command: Fan On
        num_repeats: 1
        delay_secs: 0.4
        hold_secs: 0
      target:
        entity_id: remote.basement_universal_remote
    alias: Living Room
  mode: single
- id: '1688524813925'
  alias: Master Bathroom Humidity
  description: ''
  trigger:
  - platform: device
    type: turned_off
    device_id: c29d2e813077036d4bab3e9b611dbfcc
    entity_id: light.master_bath_light
    domain: light
    id: light
  condition:
  - condition: and
    conditions:
    - condition: trigger
      id:
      - light
    - condition: or
      conditions:
      - condition: device
        type: is_on
        device_id: 92803b34ad5be7b3ad7ef608c0825d5a
        entity_id: switch.master_bath_fan
        domain: switch
      - condition: template
        value_template: '{{states.sensor.master_bath_humidity_sensor_humidity.state
          | float > states.sensor.average_climate_controlled_humidity_bathrooms.state
          | float * 1.10}}'
      - condition: template
        value_template: '{{ (now() -  states.switch.master_bath_fan.last_changed).seconds
          < 8 }}'
  action:
  - type: turn_on
    device_id: 92803b34ad5be7b3ad7ef608c0825d5a
    entity_id: switch.master_bath_fan
    domain: switch
  - delay:
      hours: 0
      minutes: 10
      seconds: 0
      milliseconds: 0
  - if:
    - condition: template
      value_template: '  {{states.sensor.master_bath_humidity_sensor_humidity.state
        | float <= states.sensor.average_climate_controlled_humidity_bathrooms.state
        | float * 1.10}}'
    then:
    - type: turn_off
      device_id: 92803b34ad5be7b3ad7ef608c0825d5a
      entity_id: switch.master_bath_fan
      domain: switch
    else:
    - wait_template: '{{states.sensor.master_bath_humidity_sensor_humidity.state |
        float < states.sensor.average_climate_controlled_humidity_bathrooms.state
        | float * 1.05}}'
      continue_on_timeout: true
    - type: turn_off
      device_id: 92803b34ad5be7b3ad7ef608c0825d5a
      entity_id: switch.master_bath_fan
      domain: switch
  mode: restart
- id: '1691364797438'
  alias: Master Bath Night Time
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.good_night_mode
    to: 'on'
    id: 'On'
  - platform: state
    entity_id:
    - input_boolean.good_night_mode
    to: 'off'
    id: 'Off'
  condition: []
  action:
  - if:
    - condition: trigger
      id: 'On'
    then:
    - device_id: c29d2e813077036d4bab3e9b611dbfcc
      domain: zwave_js
      type: set_config_parameter
      endpoint: 0
      parameter: 18
      bitmask:
      subtype: 18 (Custom Brightness Level) on endpoint 0
      value: 10
  - if:
    - condition: trigger
      id: 'Off'
    then:
    - device_id: c29d2e813077036d4bab3e9b611dbfcc
      domain: zwave_js
      type: set_config_parameter
      endpoint: 0
      parameter: 18
      bitmask:
      subtype: 18 (Custom Brightness Level) on endpoint 0
      value: 99
  mode: single
- id: '1692043138901'
  alias: Upstairs Bath Night Time
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.good_night_mode
    to: 'on'
    id: 'On'
  - platform: state
    entity_id:
    - input_boolean.good_night_mode
    to: 'off'
    id: 'Off'
  condition: []
  action:
  - if:
    - condition: trigger
      id: 'On'
    then:
    - device_id: 6d3f36694a2e5b4f48d6bd264219ca4d
      domain: zwave_js
      type: set_config_parameter
      endpoint: 0
      parameter: 18
      bitmask:
      subtype: 18 (Custom Brightness Level) on endpoint 0
      value: 45
  - if:
    - condition: trigger
      id: 'Off'
    then:
    - device_id: 6d3f36694a2e5b4f48d6bd264219ca4d
      domain: zwave_js
      type: set_config_parameter
      endpoint: 0
      parameter: 18
      bitmask:
      subtype: 18 (Custom Brightness Level) on endpoint 0
      value: 99
  mode: single
- id: '1696540824535'
  alias: Freeze Warning
  description: ''
  trigger:
  - type: temperature
    platform: device
    device_id: b6873bbfc9b9518a09870821ae2455d3
    entity_id: 56ef88290b79bfab30a992e5e08811d3
    domain: sensor
    below: 35
    id: subbasement
  - type: temperature
    platform: device
    device_id: d8dad40600ff999f3659642df23fa76c
    entity_id: 78a51b26ec14a840b4603531742ec0e7
    domain: sensor
    below: 35
    id: storage-room
  condition: []
  action:
  - if:
    - condition: trigger
      id:
      - subbasement
    then:
    - device_id: 86b1b485f0e733b3962457c610d02eae
      domain: mobile_app
      type: notify
      message: ❄️ Subbasement below 35F! ❄️
      title: ⚠️ Freeze Warning ⚠️
  - if:
    - condition: trigger
      id:
      - storage-room
    then:
    - device_id: 86b1b485f0e733b3962457c610d02eae
      domain: mobile_app
      type: notify
      message: '❄️ Storage Room is below 35F! ❄️ '
      title: '⚠️ Freeze Warning ⚠️ '
  mode: single
- id: '1696544344070'
  alias: Upstairs Bath Humidity
  description: ''
  trigger:
  - platform: device
    type: turned_off
    device_id: 6d3f36694a2e5b4f48d6bd264219ca4d
    entity_id: adbd87702f118df28d708438bf52165d
    domain: light
    id: light
  condition:
  - condition: and
    conditions:
    - condition: trigger
      id:
      - light
    - condition: or
      conditions:
      - condition: device
        type: is_on
        device_id: 210139e6bd0e25f06141a1d46ef27425
        entity_id: 7dadbc84e4d99a52ff4911bf2c71b892
        domain: switch
      - condition: template
        value_template: '{{states.sensor.upstairs_bathroom_temperature_sensor_humidity.state
          | float > states.sensor.average_climate_controlled_humidity_bathrooms.state
          | float * 1.10}}'
      - condition: template
        value_template: '{{ (now() -  states.switch.upstairs_bathroom_fan.last_changed).seconds
          < 8 }}'
  action:
  - type: turn_on
    device_id: 210139e6bd0e25f06141a1d46ef27425
    entity_id: 7dadbc84e4d99a52ff4911bf2c71b892
    domain: switch
  - delay:
      hours: 0
      minutes: 10
      seconds: 0
      milliseconds: 0
  - if:
    - condition: template
      value_template: '  {{states.sensor.upstairs_bathroom_temperature_sensor_humidity.state
        | float <= states.sensor.average_climate_controlled_humidity_bathrooms.state
        | float * 1.10}}'
    then:
    - type: turn_off
      device_id: 210139e6bd0e25f06141a1d46ef27425
      entity_id: 7dadbc84e4d99a52ff4911bf2c71b892
      domain: switch
    else:
    - wait_template: '{{states.sensor.upstairs_bathroom_temperature_sensor_humidity.state
        | float < states.sensor.average_climate_controlled_humidity_bathrooms.state
        | float * 1.05}}'
      continue_on_timeout: true
    - type: turn_off
      device_id: 210139e6bd0e25f06141a1d46ef27425
      entity_id: 7dadbc84e4d99a52ff4911bf2c71b892
      domain: switch
  mode: restart
- id: '1697148506924'
  alias: Heated Blanket Safety
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: 876ccfa73e96c6e92bbdbfc4cc139003
    entity_id: a07f5f1dec6204bc94bfd0b5a3c529ec
    domain: switch
    for:
      hours: 5
      minutes: 0
      seconds: 0
  condition: []
  action:
  - type: turn_off
    device_id: 876ccfa73e96c6e92bbdbfc4cc139003
    entity_id: a07f5f1dec6204bc94bfd0b5a3c529ec
    domain: switch
  mode: single
- id: '1697503834583'
  alias: 'Frigate: Front Porch Notifications (Mobile)'
  description: ''
  use_blueprint:
    path: SgtBatten/Stable.yaml
    input:
      camera: camera.front_door
      notify_device: 86b1b485f0e733b3962457c610d02eae
      message: '{{ label }} detected - {{ camera_name }}'
      zones:
      - porch
      - driveway
      labels:
      - person
      - package
      - cat
      - car
      cooldown: 120
      icon: mdi:cctv
      update_thumbnail: true
      critical: 'true'
      silence_timer: 45
- id: '1699998458086'
  alias: Stale Sensors
  description: ''
  trigger:
  - platform: time
    at: '19:00:00'
  condition:
  - condition: template
    value_template: '{{states.sensor.stale_sensors.state | length > 0}}'
  action:
  - service: notify.mobile_app_branden_s_phone
    data:
      message: '{{states.sensor.stale_sensors.state}}'
      title: Stale Sensors
  mode: single
- id: '1700274116436'
  alias: 'Frigate: Finnley Room Cats Notifications'
  description: ''
  use_blueprint:
    path: SgtBatten/Stable.yaml
    input:
      camera: camera.finnley_room
      notify_device: 86b1b485f0e733b3962457c610d02eae
      update_thumbnail: true
      color: amber
      icon: mdi:cctv
      zone_filter: true
      zones:
      - crib
      - changing_table
      critical: 'true'
- id: '1700855976243'
  alias: Turn off Goodnight Mode
  description: ''
  trigger:
  - platform: time
    at: 07:30:00
    id: weekday
  - platform: time
    at: 09:00:00
    id: weekend
  - platform: homeassistant
    event: start
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.good_night_mode
      state: 'on'
    - condition: or
      conditions:
      - condition: time
        before: 00:00:00
        after: 07:29:00
        weekday:
        - mon
        - tue
        - wed
        - thu
        - fri
      - condition: time
        before: 00:00:00
        after: 08:59:00
        weekday:
        - sat
        - sun
  action:
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.good_night_mode
  mode: single
- id: '1701399982576'
  alias: HASS.agent Commands
  description: ''
  trigger:
  - platform: device
    device_id: 9969a305e5424bc4ee38402562677bd0
    domain: button
    entity_id: f734e44dea14e8f0a00c3e7cd0e43ed0
    type: pressed
    id: launch_frigate_notification_clip
    enabled: false
  - platform: event
    event_type: hass_agent_notifications
  condition: []
  action:
  - if:
    - condition: template
      value_template: '{{''VIEW_CLIP'' in trigger[''event''][''data''][''action'']}}'
    then:
    - service: mqtt.publish
      data:
        topic: homeassistant/button/Branden_Desktop/Branden_Desktop-launch_frigate_notification_clip/action
        payload: '{{states(''input_text.local_url'')}}/api/frigate/notifications/{{trigger[''event''][''data''][''action''].split(''_'')[2]}}/clip.mp4'
  - if:
    - condition: template
      value_template: '{{''SNOOZE_PC_NOTIFICATIONS'' == trigger[''event''][''data''][''action'']}}'
    then:
    - service: input_boolean.turn_on
      data: {}
      target:
        entity_id: input_boolean.snoozed_frigate_pc_notifications
  - if:
    - condition: template
      value_template: '{{''FINNLEY_LIVE_FEED'' == trigger[''event''][''data''][''action'']}}'
    then:
    - service: mqtt.publish
      data:
        topic: homeassistant/button/Branden_Desktop/Branden_Desktop_launchurl/action
        payload: http://192.168.86.21:8123/dashboard-cameras/finnley-s-camera
  mode: restart
- id: '1701562649842'
  alias: Frigate Notifications (PC)
  description: ''
  trigger:
  - platform: mqtt
    topic: frigate/events
  condition:
  - condition: and
    conditions:
    - condition: or
      conditions:
      - condition: template
        value_template: '{{trigger.payload_json[''after''][''camera''] == ''front_door''
          and trigger.payload_json[''after''][''label''] in [''person'', ''cat'',
          ''car'', ''dog'']}}'
      - condition: template
        value_template: "{% set enteredZones = trigger.payload_json['after']['entered_zones']
          %} {% set watchedZones = ['crib', 'changing_table'] %} {% set isWatchedZones_ns
          = namespace(isWatchedZones=False) %} {% for zone in enteredZones %}\n  {%
          if zone in watchedZones %}\n      {% set isWatchedZones_ns.isWatchedZones
          = True %}\n  {% endif %}\n{% endfor %} {{trigger.payload_json['after']['camera']
          == 'finnley_room' and trigger.payload_json['after']['label'] in ['cat',
          'dog', 'bird'] and isWatchedZones_ns.isWatchedZones}}"
    - condition: template
      value_template: '{{trigger.payload_json[''type'']|lower == ''new''}}'
      enabled: true
    - condition: state
      entity_id: input_boolean.snoozed_frigate_pc_notifications
      state: 'off'
  action:
  - service: notify.branden_desktop
    data:
      message: A {{trigger.payload_json['after']['label']}} was detected on the Front
        Door Camera
      title: '{{trigger.payload_json[''after''][''label'']}} Detected'
      data:
        actions:
        - action: VIEW_CLIP_{{trigger.payload_json['after']['id']}}
          title: View Clip
        - action: SNOOZE_PC_NOTIFICATIONS
          title: Snooze Notifications
        image: '{{states(''input_text.local_url'')}}/api/frigate/notifications/{{trigger.payload_json[''after''][''id'']}}/thumbnail.jpg'
  mode: queued
  max: 10
- id: '1702177508628'
  alias: Basement Bathroom Humidity
  description: ''
  trigger:
  - platform: device
    type: turned_off
    device_id: 1aa9820eed11390c48d4cd68b2075c05
    entity_id: 99b5b47d2bfea6921c4c37e80f82315e
    domain: light
    id: light
  condition:
  - condition: and
    conditions:
    - condition: trigger
      id:
      - light
    - condition: or
      conditions:
      - condition: device
        type: is_on
        device_id: 12356bc6f057627c71644c188fcb5183
        entity_id: 7b797aca3d7fdc94fbd9e14cb939bdf0
        domain: switch
      - condition: template
        value_template: '{{states.sensor.upstairs_bathroom_temperature_sensor_humidity.state
          | float > states.sensor.average_climate_controlled_humidity_bathrooms.state
          | float * 1.10}}'
        enabled: false
      - condition: template
        value_template: '{{ (now() -  states.switch.basement_bathroom_fan.last_changed).seconds
          < 8 }}'
  action:
  - type: turn_on
    device_id: 12356bc6f057627c71644c188fcb5183
    entity_id: 7b797aca3d7fdc94fbd9e14cb939bdf0
    domain: switch
  - delay:
      hours: 0
      minutes: 10
      seconds: 0
      milliseconds: 0
  - if:
    - condition: template
      value_template: '  {{states.sensor.upstairs_bathroom_temperature_sensor_humidity.state
        | float <= states.sensor.average_climate_controlled_humidity_bathrooms.state
        | float * 1.10}}'
    then:
    - type: turn_off
      device_id: 210139e6bd0e25f06141a1d46ef27425
      entity_id: 7dadbc84e4d99a52ff4911bf2c71b892
      domain: switch
    else:
    - wait_template: '{{states.sensor.upstairs_bathroom_temperature_sensor_humidity.state
        | float < states.sensor.average_climate_controlled_humidity_bathrooms.state
        | float * 1.05}}'
      continue_on_timeout: true
    - type: turn_off
      device_id: 92803b34ad5be7b3ad7ef608c0825d5a
      entity_id: switch.master_bath_fan
      domain: switch
    enabled: false
  - type: turn_off
    device_id: 12356bc6f057627c71644c188fcb5183
    entity_id: 7b797aca3d7fdc94fbd9e14cb939bdf0
    domain: switch
  mode: restart
- id: '1702177691825'
  alias: Home Assistant Starts
  description: ''
  trigger:
  - platform: homeassistant
    event: start
  condition: []
  action:
  - service: notify.mobile_app_branden_s_phone
    data:
      message: Home Assistant has just started
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.frontyard_visibility
  mode: single
- id: '1702764881465'
  alias: Frontyard Visibilty Changed
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.frontyard_visibility
    to: 'on'
    id: turned_on
  - platform: state
    entity_id:
    - input_boolean.frontyard_visibility
    to: 'off'
    id: turned_off
  condition: []
  action:
  - if:
    - condition: trigger
      id:
      - turned_on
    then:
    - service: script.switch_to_front_yard_visibility_and_back
      data: {}
  - if:
    - condition: trigger
      id:
      - turned_off
    then:
    - service: scene.turn_on
      data: {}
      target:
        entity_id: scene.frontyard_previous
    - delay:
        hours: 0
        minutes: 0
        seconds: 3
        milliseconds: 0
    - service: scene.create
      data:
        scene_id: frontyard_previous
        snapshot_entities:
        - light.outdoor_sconce_light_1
        - light.outdoor_sconce_light_2
        - light.outdoor_sconce_light_3
        - light.outdoor_sconce_light_4
        - light.porch_light
  mode: restart
- id: '1702765706909'
  alias: Frontporch / driveway person/car
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.front_porch_person_count
    - sensor.driveway_car_count
    - sensor.driveway_person_count
    from: '0'
    to:
  condition:
  - condition: sun
    before: sunrise
    after: sunset
    before_offset: '1:00:00'
    after_offset: '-1:00:00'
  - condition: state
    entity_id: input_boolean.disable_frontyard_visibility
    state: 'off'
  action:
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.frontyard_visibility
  - delay:
      hours: 0
      minutes: 10
      seconds: 0
      milliseconds: 0
  - wait_template: '{{states(''sensor.front_porch_person_count'') | int <= 0 and states(''sensor.driveway_person_count'')
      | int <= 0}}'
    continue_on_timeout: true
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.frontyard_visibility
  mode: restart
- id: '1704146876849'
  alias: Heated Blanket
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: 876ccfa73e96c6e92bbdbfc4cc139003
    entity_id: a07f5f1dec6204bc94bfd0b5a3c529ec
    domain: switch
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - type: turn_on
    device_id: b4f27ae4844874a563008559d106f098
    entity_id: 0cdcf3c199fe52b2c1e230e8e57b5276
    domain: switch
  mode: single
- id: '1704154185925'
  alias: Baby Buddy Buttons
  description: ''
  trigger:
  - platform: device
    domain: mqtt
    device_id: 80c996aef1daadbad8c4ffc3926a0921
    type: action
    subtype: 'on'
    discovery_id: 0x4c5bb3fffe4c336b action_on
    id: feeding_trigger
  - platform: device
    domain: mqtt
    device_id: 8a0e66269e863f771847626e4793deb8
    type: action
    subtype: 'on'
    discovery_id: 0x4c5bb3fffe462b16 action_on
    id: feeding_trigger
  - platform: device
    domain: mqtt
    device_id: ff5d548ecb6d3bc0c57107012bc65e57
    type: action
    subtype: 'on'
    discovery_id: 0x84ba20fffed1b83e action_on
    id: feeding_trigger
  - platform: device
    domain: mqtt
    device_id: 80c996aef1daadbad8c4ffc3926a0921
    type: action
    subtype: arrow_left_click
    discovery_id: 0x4c5bb3fffe4c336b action_arrow_left_click
    id: wet_diaper_trigger
  - platform: device
    domain: mqtt
    device_id: 8a0e66269e863f771847626e4793deb8
    type: action
    subtype: arrow_left_click
    discovery_id: 0x4c5bb3fffe462b16 action_arrow_left_click
    id: wet_diaper_trigger
  - platform: device
    domain: mqtt
    device_id: ff5d548ecb6d3bc0c57107012bc65e57
    type: action
    subtype: arrow_left_click
    discovery_id: 0x84ba20fffed1b83e action_arrow_left_click
    id: wet_diaper_trigger
  - platform: device
    domain: mqtt
    device_id: 80c996aef1daadbad8c4ffc3926a0921
    type: action
    subtype: arrow_right_click
    discovery_id: 0x4c5bb3fffe4c336b action_arrow_right_click
    id: solid_diaper_trigger
  - platform: device
    domain: mqtt
    device_id: 8a0e66269e863f771847626e4793deb8
    type: action
    subtype: arrow_right_click
    discovery_id: 0x4c5bb3fffe462b16 action_arrow_right_click
    id: solid_diaper_trigger
  - platform: device
    domain: mqtt
    device_id: ff5d548ecb6d3bc0c57107012bc65e57
    type: action
    subtype: arrow_right_click
    discovery_id: 0x84ba20fffed1b83e action_arrow_right_click
    id: solid_diaper_trigger
  - platform: device
    domain: mqtt
    device_id: 80c996aef1daadbad8c4ffc3926a0921
    type: action
    subtype: 'off'
    discovery_id: 0x4c5bb3fffe4c336b action_off
    id: wet_solid_diaper_trigger
  - platform: device
    domain: mqtt
    device_id: 8a0e66269e863f771847626e4793deb8
    type: action
    subtype: 'off'
    discovery_id: 0x4c5bb3fffe462b16 action_off
    id: wet_solid_diaper_trigger
  - platform: device
    domain: mqtt
    device_id: ff5d548ecb6d3bc0c57107012bc65e57
    type: action
    subtype: 'off'
    discovery_id: 0x84ba20fffed1b83e action_off
    id: wet_solid_diaper_trigger
  - platform: device
    domain: mqtt
    device_id: 80c996aef1daadbad8c4ffc3926a0921
    type: action
    subtype: brightness_move_up
    discovery_id: 0x4c5bb3fffe4c336b action_brightness_move_up
    id: feeding_timer_toggle_trigger
  - platform: device
    domain: mqtt
    device_id: 8a0e66269e863f771847626e4793deb8
    type: action
    subtype: brightness_move_up
    discovery_id: 0x4c5bb3fffe462b16 action_brightness_move_up
    id: feeding_timer_toggle_trigger
  - platform: device
    domain: mqtt
    device_id: ff5d548ecb6d3bc0c57107012bc65e57
    type: action
    subtype: brightness_move_up
    discovery_id: 0x84ba20fffed1b83e action_brightness_move_up
    id: feeding_timer_toggle_trigger
  - platform: device
    domain: mqtt
    device_id: 80c996aef1daadbad8c4ffc3926a0921
    type: action
    subtype: brightness_move_down
    discovery_id: 0x4c5bb3fffe4c336b action_brightness_move_down
    id: sleep_trigger
  - platform: device
    domain: mqtt
    device_id: 8a0e66269e863f771847626e4793deb8
    type: action
    subtype: brightness_move_down
    discovery_id: 0x4c5bb3fffe462b16 action_brightness_move_down
    id: sleep_trigger
  - platform: device
    domain: mqtt
    device_id: ff5d548ecb6d3bc0c57107012bc65e57
    type: action
    subtype: brightness_move_down
    discovery_id: 0x84ba20fffed1b83e action_brightness_move_down
    id: sleep_trigger
  condition: []
  action:
  - if:
    - condition: and
      conditions:
      - condition: trigger
        id:
        - wet_diaper_trigger
        - solid_diaper_trigger
        - wet_solid_diaper_trigger
    then:
    - if:
      - condition: template
        value_template: '{{"Master Bedroom" in trigger.topic}}'
        enabled: true
      then:
      - wait_for_trigger:
        - platform: device
          domain: mqtt
          device_id: 8a0e66269e863f771847626e4793deb8
          type: action
          subtype: arrow_left_click
          discovery_id: 0x4c5bb3fffe462b16 action_arrow_left_click
        - platform: device
          domain: mqtt
          device_id: 8a0e66269e863f771847626e4793deb8
          type: action
          subtype: 'off'
          discovery_id: 0x4c5bb3fffe462b16 action_off
        - platform: device
          domain: mqtt
          device_id: 8a0e66269e863f771847626e4793deb8
          type: action
          subtype: arrow_right_click
          discovery_id: 0x4c5bb3fffe462b16 action_arrow_right_click
        timeout:
          hours: 0
          minutes: 0
          seconds: 3
          milliseconds: 0
      - if:
        - condition: template
          value_template: '{{not wait.trigger}}'
        then:
        - service: select.select_option
          data:
            option: '{% if trigger.id == ''wet_diaper_trigger'' %} Wet {% elif trigger.id
              == ''solid_diaper_trigger'' %} Solid {% elif trigger.id == ''wet_solid_diaper_trigger''
              %} Wet and Solid {%endif%}'
          target:
            entity_id: select.baby_buddy_diaper_type
        - service: input_datetime.set_datetime
          metadata: {}
          data:
            datetime: '{{now()}}'
          target:
            entity_id: input_datetime.finnley_diaper_change_time
        - service: script.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: script.baby_buddy_finnley_diaper_change
        else:
        - if:
          - condition: template
            value_template: '{{wait.trigger.payload == ''arrow_left_click''}}'
          then:
          - type: toggle
            device_id: fc14d585e20bc18f0fae2b868f5849f3
            entity_id: c6e3361713d1b57b3eb8fc217f9c08b4
            domain: light
        - if:
          - condition: template
            value_template: '{{wait.trigger.payload == ''arrow_right_click''}}'
          then:
          - service: switch.turn_on
            target:
              device_id: baf57ba037f975caf4dced6631ef5ce8
            data: {}
        - if:
          - condition: template
            value_template: '{{wait.trigger.payload == ''off''}}'
          then:
          - type: turn_on
            device_id: baf57ba037f975caf4dced6631ef5ce8
            entity_id: b7d915334e8a7fb6547fe9806c33eb9e
            domain: switch
      else:
      - service: select.select_option
        data:
          option: '{% if trigger.id == ''wet_diaper_trigger'' %} Wet {% elif trigger.id
            == ''solid_diaper_trigger'' %} Solid {% elif trigger.id == ''wet_solid_diaper_trigger''
            %} Wet and Solid {%endif%}'
        target:
          entity_id: select.baby_buddy_diaper_type
      - service: input_datetime.set_datetime
        metadata: {}
        data:
          datetime: '{{now()}}'
        target:
          entity_id: input_datetime.finnley_diaper_change_time
      - service: script.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: script.baby_buddy_finnley_diaper_change
    enabled: true
  - if:
    - condition: and
      conditions:
      - condition: trigger
        id:
        - feeding_trigger
    then:
    - if:
      - condition: template
        value_template: '{{"Master Bedroom" in trigger.topic}}'
      then:
      - wait_for_trigger:
        - platform: device
          domain: mqtt
          device_id: 8a0e66269e863f771847626e4793deb8
          type: action
          subtype: 'on'
          discovery_id: 0x4c5bb3fffe462b16 action_on
        timeout:
          hours: 0
          minutes: 0
          seconds: 3
          milliseconds: 0
      - if:
        - condition: template
          value_template: '{{not wait.trigger}}'
        then:
        - service: script.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: script.set_finnley_start_feeding_time_to_now
        - service: script.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: script.baby_buddy_test
        else:
        - if:
          - condition: template
            value_template: '{{wait.trigger.payload == ''on''}}'
          then:
          - type: turn_off
            device_id: baf57ba037f975caf4dced6631ef5ce8
            entity_id: b7d915334e8a7fb6547fe9806c33eb9e
            domain: switch
      else:
      - service: script.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: script.set_finnley_start_feeding_time_to_now
      - service: script.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: script.baby_buddy_test
    enabled: true
  - if:
    - condition: trigger
      id:
      - feeding_trigger
    then:
    - service: script.set_finnley_start_feeding_time_to_now
      metadata: {}
      data: {}
    - service: script.baby_buddy_test
      data: {}
    enabled: false
  - if:
    - condition: trigger
      id:
      - wet_diaper_trigger
      - solid_diaper_trigger
      - wet_solid_diaper_trigger
    then:
    - service: select.select_option
      data:
        option: '{% if trigger.id == ''wet_diaper_trigger'' %} Wet {% elif trigger.id
          == ''solid_diaper_trigger'' %} Solid {% elif trigger.id == ''wet_solid_diaper_trigger''
          %} Wet and Solid {%endif%}'
      target:
        entity_id: select.baby_buddy_diaper_type
    - service: input_datetime.set_datetime
      metadata: {}
      data:
        datetime: '{{now()}}'
      target:
        entity_id: input_datetime.finnley_diaper_change_time
    - service: script.baby_buddy_finnley_diaper_change
      data: {}
    enabled: false
  - if:
    - condition: trigger
      id:
      - feeding_timer_toggle_trigger
    then:
    - if:
      - condition: template
        value_template: '{{states(''timer.finnley_feeding_timer'') == ''active''}}'
      then:
      - service: script.toggle_finnley_feeding_timer
        data: {}
      - service: script.baby_buddy_test
        metadata: {}
        data: {}
      else:
      - service: script.toggle_finnley_feeding_timer
        data: {}
  - if:
    - condition: trigger
      id:
      - sleep_trigger
    then:
    - service: script.baby_buddy_finnley_sleep
      data: {}
      enabled: false
    - service: input_datetime.set_datetime
      metadata: {}
      data:
        datetime: '{{now()}}'
      target:
        entity_id: input_datetime.pumping_start_time
    - service: script.turn_on
      target:
        entity_id: script.baby_buddy_finnley_pumping
      data: {}
  mode: single
- id: '1704164614912'
  alias: Reset Snoozed Frigate Notifications
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.snoozed_frigate_pc_notifications
    to: 'on'
    for:
      hours: 0
      minutes: 30
      seconds: 0
  condition: []
  action:
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.snoozed_frigate_pc_notifications
  mode: single
- id: '1704343770899'
  alias: Master Bedroom Bed Motion
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.master_underbed_motion_sensor_branden_side_motion
    to: 'on'
    enabled: false
  - platform: state
    entity_id:
    - binary_sensor.master_underbed_motion_sensor_samantha_side_motion
    enabled: false
    to: 'on'
  - platform: device
    domain: mqtt
    device_id: 4123d53d80bf262f32a413067ab8812b
    type: action
    subtype: hold
    discovery_id: 0x00158d0008393dbe action_hold
  condition: []
  action:
  - type: toggle
    device_id: c7d0f87a2a9d9c765892a9d5e9f5924a
    entity_id: f134af8facf63fbd170622fcd6275e7e
    domain: light
  - repeat:
      sequence:
      - delay:
          hours: 0
          minutes: 0
          seconds: 1
          milliseconds: 0
      while:
      - condition: or
        conditions:
        - condition: or
          conditions:
          - condition: not
            conditions:
            - type: is_no_motion
              condition: device
              device_id: fd44d9316525d7e8e2c66fa38a70c1c6
              entity_id: 71679ed1badaf26f72fc2a08d2fe1411
              domain: binary_sensor
              for:
                hours: 0
                minutes: 0
                seconds: 8
          - condition: not
            conditions:
            - type: is_no_motion
              condition: device
              device_id: fd44d9316525d7e8e2c66fa38a70c1c6
              entity_id: 6aa2cdad73ed899af65eb9f9217bc7a0
              domain: binary_sensor
              for:
                hours: 0
                minutes: 0
                seconds: 8
        - condition: not
          conditions:
          - condition: device
            type: is_on
            device_id: c7d0f87a2a9d9c765892a9d5e9f5924a
            entity_id: f134af8facf63fbd170622fcd6275e7e
            domain: light
            for:
              hours: 0
              minutes: 0
              seconds: 12
    enabled: false
  - type: turn_off
    device_id: c7d0f87a2a9d9c765892a9d5e9f5924a
    entity_id: f134af8facf63fbd170622fcd6275e7e
    domain: light
    enabled: false
  mode: restart
- id: '1704508016555'
  alias: Coffee Pot
  description: ''
  trigger:
  - platform: device
    type: turned_off
    device_id: 94f08c0f4eea821bff6fee7adc81377b
    entity_id: 6a800b3343e78cd9c31455ab829ec30f
    domain: switch
    for:
      hours: 0
      minutes: 30
      seconds: 0
  condition: []
  action:
  - type: turn_on
    device_id: 94f08c0f4eea821bff6fee7adc81377b
    entity_id: 6a800b3343e78cd9c31455ab829ec30f
    domain: switch
  mode: single
- id: '1704749961418'
  alias: Baby Buddy - Forms
  description: ''
  trigger:
  - platform: state
    entity_id:
    - timer.finnley_feeding_timer
    to: active
    id: finnley_feeding_timer_started
    from: idle
  - platform: state
    entity_id:
    - timer.finnley_feeding_timer
    to: paused
    id: finnley_feeding_timer_paused
  - platform: event
    event_type: FINNLEY_FEEDING_CONFIRMED
    id: submit_feeding_form
  - platform: event
    event_type: FINNLEY_DIAPER_CHANGE_CONFIRMED
    id: submit_diaper_change
  - platform: state
    entity_id:
    - timer.finnley_sleep_timer
    to: idle
    id: finnley_sleep_timer_stopped
  - platform: state
    entity_id:
    - timer.finnley_sleep_timer
    to: active
    id: finnley_sleep_timer_started
  - platform: event
    event_type: FINNLEY_SLEEP_CONFIRMED
    id: submit_sleep
  - platform: event
    event_type: FINNLEY_PUMPING_CONFIRMED
    id: submit_pumping
  - platform: state
    entity_id:
    - select.baby_buddy_feeding_method
    to: Bottle
    id: feeding_bottle_selected
  - platform: event
    event_type: FINNLEY_TUMMY_TIME_CONFIRMED
    id: tummy_time_confirmed
  condition: []
  action:
  - if:
    - condition: trigger
      id:
      - finnley_feeding_timer_started
    then:
    - service: input_datetime.set_datetime
      target:
        entity_id: input_datetime.finnley_feeding_start_time
      data:
        datetime: '{{ now() }}'
  - if:
    - condition: trigger
      id:
      - finnley_feeding_timer_stopped
    then:
    - service: input_boolean.turn_off
      metadata: {}
      data: {}
      target:
        entity_id: input_boolean.finnley_feeding_use_timer
  - if:
    - condition: and
      conditions:
      - condition: trigger
        id:
        - submit_diaper_change
      - condition: state
        entity_id: input_boolean.waiting_for_finnley_diaper_change_confirmation
        state: 'off'
    then:
    - service: script.submit_baby_buddy_diaper_change
      data: {}
  - if:
    - condition: and
      conditions:
      - condition: trigger
        id:
        - submit_feeding_form
      - condition: state
        entity_id: input_boolean.waiting_for_finnley_feeding_confirmation
        state: 'off'
    then:
    - if:
      - alias: Test if bottle feeding has an amount
        condition: template
        value_template: '{{states(''select.baby_buddy_feeding_method'') |lower ==
          ''bottle'' and states(''input_number.finnley_feeding_amount'')|float ==
          0.0}}'
      then:
      - service: input_text.set_value
        metadata: {}
        data:
          value: Bottle feeding must have an amount!
        target:
          entity_id: input_text.finnley_feeding_info_message
      - stop: Bottle feeding must have an amount
      else: []
    - if:
      - condition: template
        value_template: "{{states('select.baby_buddy_feeding_method') | lower in ['left
          breast', 'right breast', 'both breasts'] \n  and as_timestamp(states('input_datetime.finnley_feeding_start_time'))
          >= as_timestamp(states('input_datetime.finnley_feeding_stop_time'))}}"
        alias: Test if end time is after start time for breast feeding
      then:
      - service: input_text.set_value
        metadata: {}
        data:
          value: End time must be after start time for breast feeding
        target:
          entity_id: input_text.finnley_feeding_info_message
      - stop: End time must be after start time for breast feeding
      else: []
    - if:
      - condition: template
        value_template: '{{states(''select.baby_buddy_feeding_method'') | lower in
          [''left breast'', ''right breast'', ''both breasts''] and states(''input_number.finnley_feeding_amount'')|float
          != 0.0}}'
        alias: Test if breast feeding has an amount
      then:
      - service: input_text.set_value
        metadata: {}
        data:
          value: Breast feeding should not have an amount!
        target:
          entity_id: input_text.finnley_feeding_info_message
      - stop: Breast feeding should not have an amount
      else: []
    - if:
      - condition: template
        value_template: '{{states(''select.baby_buddy_feeding_method'') | lower in
          [''left breast'', ''right breast'', ''both breasts''] and states(''select.baby_buddy_feeding_type'')|lower
          != ''breast milk''}}'
        alias: Test if breast feeding is of type breast milk
      then:
      - service: input_text.set_value
        metadata: {}
        data:
          value: Breast feeding should always be have type Breast Milk!
        target:
          entity_id: input_text.finnley_feeding_info_message
      - stop: Breast feeding should always be have type Breast Milk
      else: []
    - if:
      - condition: template
        value_template: '{{states(''select.baby_buddy_feeding_method'') | lower ==
          ''bottle'' and  as_timestamp(states(''input_datetime.finnley_feeding_start_time''))
          != as_timestamp(states(''input_datetime.finnley_feeding_stop_time''))}}'
        alias: Test if end time equals start time for bottle feeding
      then:
      - service: input_text.set_value
        metadata: {}
        data:
          value: End time must equal start time for bottle feeding!
        target:
          entity_id: input_text.finnley_feeding_info_message
      - stop: End time must equal start time for bottle feeding
      else: []
    - if:
      - condition: template
        value_template: "{{as_timestamp(strptime(states('input_datetime.finnley_feeding_start_time'),
          '%Y-%m-%d %H:%M:%S')) | timestamp_custom(\"%Y\")|int <= now().year - 1\n
          \ or\n  as_timestamp(strptime(states('input_datetime.finnley_feeding_stop_time'),
          '%Y-%m-%d %H:%M:%S')) | timestamp_custom(\"%Y\")|int <= now().year - 1\n}}"
        alias: Test if start and end times are set
      then:
      - service: input_text.set_value
        metadata: {}
        data:
          value: Start and end times must be set!
        target:
          entity_id: input_text.finnley_feeding_info_message
      - stop: Start and end times must be set
      else: []
    - service: script.submit_baby_buddy_feeding
      metadata: {}
      data: {}
  - if:
    - condition: trigger
      id:
      - finnley_feeding_timer_paused
    then:
    - service: input_datetime.set_datetime
      target:
        entity_id: input_datetime.finnley_feeding_stop_time
      data:
        datetime: '{{ now() }}'
  - if:
    - condition: trigger
      id:
      - finnley_sleep_timer_started
    then:
    - service: input_boolean.turn_on
      metadata: {}
      data: {}
      target:
        entity_id: input_boolean.finnley_sleep_use_timer
  - if:
    - condition: and
      conditions:
      - condition: trigger
        id:
        - submit_sleep
      - condition: state
        entity_id: input_boolean.waiting_for_finnley_sleep_confirmation
        state: 'off'
    then:
    - service: script.submit_baby_buddy_sleep
      data: {}
    enabled: true
  - if:
    - condition: and
      conditions:
      - condition: trigger
        id:
        - submit_pumping
      - condition: state
        entity_id: input_boolean.waiting_for_finnley_pumping_confirmation
        state: 'off'
    then:
    - if:
      - condition: template
        value_template: '{{states(''input_number.pumping_amount'')|float == 0.0}}'
      then:
      - service: input_text.set_value
        metadata: {}
        data:
          value: Pumping must have an amount!
        target:
          entity_id: input_text.finnley_pumping_info_message
      - stop: Pumping must have amount
    - service: script.submit_baby_buddy_pumping
      data: {}
  - if:
    - condition: trigger
      id:
      - feeding_bottle_selected
    then:
    - service: input_datetime.set_datetime
      metadata: {}
      data:
        datetime: '{{states(''input_datetime.finnley_feeding_start_time'')}}'
      target:
        entity_id: input_datetime.finnley_feeding_stop_time
  - if:
    - condition: trigger
      id:
      - tummy_time_confirmed
    then:
    - if:
      - alias: Check if stop time is after start time
        condition: template
        value_template: '{{as_timestamp(states(''input_datetime.finnley_tummy_time_start''))
          >= as_timestamp(states(''input_datetime.finnley_tummy_time_stop''))}}'
      then:
      - service: input_text.set_value
        target:
          entity_id: input_text.finnley_tummy_time_info_message
        data:
          value: Stop time should be after start time!
      - stop: Stop time should be after start time
    - service: script.submit_baby_buddy_tummy_time
      metadata: {}
      data: {}
  mode: parallel
  max: 10
- id: '1709497515323'
  alias: Frigate Notifications - Crying
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.finnley_room_crying_sound
    - binary_sensor.finnley_room_speech_sound
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 1
  condition: []
  action:
  - service: notify.all_mobile_phones
    data:
      message: clear_notification
      data:
        tag: finnley_crying_notification
    enabled: false
  - service: "{%if states('binary_sensor.is_branden_home') and states('binary_sensor.is_samantha_home')
      %}\n  notify.all_mobile_phones\n{% elif states('binary_sensor.is_branden_home')
      %}\n  branden\n{% elif states('binary_sensor.is_samantha_home') %}\n  sam\n{%endif%}"
    data:
      title: Baby!
      message: Baby is making noise!
      data:
        critical: true
        ttl: 0
        priority: high
        notification_icon: mdi:ear-hearing
        tag: finnley_crying_notification
        actions:
        - action: URI
          title: Live Feed
          uri: /dashboard-cameras/finnley-s-camera
        image: http://192.168.86.21:8000/media/child/picture/20240301_140331.jpg
        vibrationPattern: 1250 250
        channel: Crying
  - service: notify.branden_desktop
    data:
      message: Baby!
      title: Baby is making noise!
      data:
        actions:
        - action: FINNLEY_LIVE_FEED
          title: Live Feed
        image: http://192.168.86.21:8000/media/child/picture/20240301_140331.jpg
  mode: queued
  max: 10
- id: '1710348570969'
  alias: Finnley Room Fan
  description: ''
  trigger:
  - platform: event
    event_type: zwave_js_value_notification
    event_data:
      device_id: 271b54528ef7dc397f28f1200a8f11b8
      value: 255
  condition: []
  action:
  - type: toggle
    device_id: b47adfbdffd61cfbe4a91df9331b1c05
    entity_id: 838bd176af233578b9eaebe2d67c3aae
    domain: light
  mode: single
- id: '1710619107909'
  alias: Laundry Room Light
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 6beca227eb0e580630d2462d9d43203c
    entity_id: eff2c01c090a5c0754863eb8b6245471
    domain: binary_sensor
    id: Door_open
  - type: not_opened
    platform: device
    device_id: 6beca227eb0e580630d2462d9d43203c
    entity_id: eff2c01c090a5c0754863eb8b6245471
    domain: binary_sensor
    id: Door_closed
    for:
      hours: 0
      minutes: 3
      seconds: 0
  condition: []
  action:
  - if:
    - condition: trigger
      id:
      - Door_open
    then:
    - type: turn_on
      device_id: df0e508a257fdfeefae0b8057b65b26f
      entity_id: 937d402008a5524c73d3210a57a40b06
      domain: switch
  - if:
    - condition: trigger
      id:
      - Door_closed
    then:
    - type: turn_off
      device_id: df0e508a257fdfeefae0b8057b65b26f
      entity_id: 937d402008a5524c73d3210a57a40b06
      domain: switch
  mode: single
- id: '1711391382479'
  alias: Litter Robot Notifications
  description: ''
  trigger:
  - type: value
    platform: device
    device_id: 9c5503844279813835773d316a5ffde8
    entity_id: 619e4f7c416f4438647a2980b8aff17c
    domain: sensor
    above: 80
    id: box_needs_attention
  - type: value
    platform: device
    device_id: 9c5503844279813835773d316a5ffde8
    entity_id: e3d39aa58d223372c0542115b6198832
    domain: sensor
    below: 81
    id: box_needs_attention
  - type: value
    platform: device
    device_id: 9c5503844279813835773d316a5ffde8
    entity_id: 619e4f7c416f4438647a2980b8aff17c
    domain: sensor
    below: 80
    id: box_issue_addressed
  - type: value
    platform: device
    device_id: 9c5503844279813835773d316a5ffde8
    entity_id: e3d39aa58d223372c0542115b6198832
    domain: sensor
    id: box_issue_addressed
    above: 95
  condition: []
  action:
  - if:
    - condition: trigger
      id:
      - box_needs_attention
    then:
    - service: notify.mobile_app_branden_s_phone
      data:
        title: Litter Box
        message: Litter Box Needs Attention
        data:
          critical: true
          ttl: 0
          priority: high
          notification_icon: mdi:cat
          tag: litter_box_needs_attention
          actions:
          - action: URI
            title: Litter Box Info
            uri: /config/devices/device/9c5503844279813835773d316a5ffde8
    - device_id: 171c8f1cbdc67a075d1170858166fd45
      domain: zwave_js
      type: set_config_parameter
      endpoint: 0
      parameter: 26
      bitmask:
      subtype: 26 (Status LED 6 Color) on endpoint 0
      value: 2
    - device_id: 171c8f1cbdc67a075d1170858166fd45
      domain: zwave_js
      type: set_config_parameter
      endpoint: 0
      parameter: 31
      bitmask: 32
      subtype: 31[0x20] on endpoint 0 (LED 6 Blink Status) on endpoint 0
      value: 1
    - device_id: fc14d585e20bc18f0fae2b868f5849f3
      domain: zwave_js
      type: set_config_parameter
      endpoint: 0
      parameter: 26
      bitmask:
      subtype: 26 (Status LED 6 Color) on endpoint 0
      value: 2
    - device_id: fc14d585e20bc18f0fae2b868f5849f3
      domain: zwave_js
      type: set_config_parameter
      endpoint: 0
      parameter: 31
      bitmask: 32
      subtype: 31[0x20] on endpoint 0 (LED 6 Blink Status) on endpoint 0
      value: 1
  - if:
    - condition: trigger
      id:
      - box_issue_addressed
    then:
    - service: notify.mobile_app_branden_s_phone
      data:
        message: clear_notification
        data:
          tag: litter_box_needs_attention
    - device_id: 171c8f1cbdc67a075d1170858166fd45
      domain: zwave_js
      type: set_config_parameter
      endpoint: 0
      parameter: 26
      bitmask:
      subtype: 26 (Status LED 6 Color) on endpoint 0
      value: 0
    - device_id: fc14d585e20bc18f0fae2b868f5849f3
      domain: zwave_js
      type: set_config_parameter
      endpoint: 0
      parameter: 26
      bitmask:
      subtype: 26 (Status LED 6 Color) on endpoint 0
      value: 0
  mode: single
- id: '1713139745652'
  alias: Washer
  description: ''
  trigger:
  - type: power
    platform: device
    device_id: f01d275ee6ed764a669c499dfeee474e
    entity_id: f88299b8f4bfe41d1695f312e8d6e35f
    domain: sensor
    above: 10
  condition: []
  action:
  - wait_for_trigger:
    - type: power
      platform: device
      device_id: f01d275ee6ed764a669c499dfeee474e
      entity_id: f88299b8f4bfe41d1695f312e8d6e35f
      domain: sensor
      below: 2
      for:
        hours: 0
        minutes: 5
        seconds: 0
    timeout:
      hours: 1
      minutes: 30
      seconds: 0
      milliseconds: 0
    continue_on_timeout: false
  - if:
    - condition: and
      conditions:
      - condition: state
        entity_id: binary_sensor.is_branden_home
        state: 'off'
      - condition: state
        entity_id: binary_sensor.is_samantha_home
        state: 'off'
    then:
    - wait_for_trigger:
      - platform: state
        entity_id:
        - binary_sensor.is_branden_home
        to: 'on'
      - platform: state
        entity_id:
        - binary_sensor.is_samantha_home
        to: 'on'
      continue_on_timeout: true
  - if:
    - condition: state
      entity_id: binary_sensor.is_branden_home
      state: 'on'
    then:
      service: "{%if states('binary_sensor.is_branden_home') and states('binary_sensor.is_samantha_home')
        %}\n  notify.all_mobile_phones        \n{% elif states('binary_sensor.is_branden_home')
        %}\n  branden\n{% elif states('binary_sensor.is_samantha_home') %}\n  sam\n{%endif%}"
      data:
        message: Don't forget to put the clothes in the dryer
        title: Washer is done!
        data:
          critical: true
          notification_icon: mdi:washing-machine-alert
          ttl: 0
          priority: high
          tag: washing_machine_done
          channel: WashingMachine
      enabled: true
  mode: single
